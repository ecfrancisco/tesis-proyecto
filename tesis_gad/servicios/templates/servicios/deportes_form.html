{% extends 'base.html' %}
{% load static %}

{% block head_end %}
{{ block.super }}


{% block css %}

<link rel="stylesheet" type="text/css" href="{% static 'plugins/admin/css/style.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'plugins/bootstrap-5.2.2-dist/css/bootstrap.min.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'plugins/Tempus-Dominus/tempus-dominus.css' %}">

{% endblock %}


{% endblock head_end %}

{% block body_start %}
{{ block.super }}

{% endblock %}

{% block body_content %}

<style>
    .principal {
        min-height: 70vh;
        align-items: center;
        background: #5b9155;
        font-family: Montserrat, Arial, Helvetica, sans-serif;
    }

    .container {
        padding: 20px;
        width: 76rem;
        border: 1px solid #ccc;
        border-radius: 10px;
        background: white;
        box-shadow: 2px 1px 21px -9px rgba(0, 0, 0, 0.38);
    }
</style>

<!-- ################################# FRONT-END ######################################### -->

<nav class="navbar navbar-expand-lg bg-body-tertiary">
    <div class="container-fluid">
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                    <img src="/static/img/Logo-Alcaldia-2023.png" alt="" style="height: 4rem">
                </li>
                <li class="nav-item">
                    <img src="/static/img/servicios.png" alt="" style="height: 4rem">
                </li>
            </ul>
        </div>
    </div>
</nav>

<div class="principal">
    <br><br><br>
    <div class="container">
        <div class="container-fluid">
            <form novalidate>
                <div class="row">
                    <div class="col-md-3">
                        <label for="zona_eleccion" class="form-label" title="Zona donde tomará el curso">Zona de su
                            Elección:</label>
                        <div class="input-group" style="padding-top: 0.4rem;">
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="zona_eleccion" id="zona_urbana"
                                    value="urbana" checked>
                                <label class="form-check-label" for="zona_urbana">Urbana</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="zona_eleccion" id="zona_rural"
                                    value="rural">
                                <label class="form-check-label" for="zona_rural">Rural</label>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-3">
                        <label for="horario_label" class="form-label">Franja
                            horaria:</label>
                        <div class="input-group" style="padding-top: 0.4rem;">
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="horario" id="matutino"
                                    value="matutino" checked>
                                <label class="form-check-label" for="matutino">Matutino</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="horario" id="vespertino"
                                    value="vespertino">
                                <label class="form-check-label" for="vespertino">Vespertino</label>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-3">
                        <label for="flt_curso" class="form-label">Curso:</label>
                        <select class="form-select" id="flt_curso" name="flt_curso">
                            <option selected>Elija un curso</option>
                            <option value="futbol">Fútbol</option>
                            <option value="basquet">Básquet</option>
                        </select>
                        <input id="flt_curso_list" name="flt_curso_list" value="" type="hidden">
                    </div>

                    <div class="col-md-3">
                        <label for="flt_genero" class="form-label">Género:</label>
                        <select class="form-select" id="flt_genero" name="flt_genero">
                            <option selected>Elija un género</option>
                            <option value="masculino">Masculino</option>
                            <option value="femenino">Femenino</option>
                        </select>
                        <input id="flt_genero_list" name="flt_genero_list" value="" type="hidden">
                    </div>
                </div>

                <br>

                <div class="row">
                    <div class="col-md-3">
                        <label for="flt_nombre_1" class="form-label">Primer nombre</label>
                        <input type="text" class="form-control" id="flt_nombre_1" placeholder="Ingrese primer nombre"
                            required>
                        <div class="valid-feedback">
                            Perfecto!
                        </div>
                    </div>

                    <div class="col-md-3">
                        <label for="flt_nombre_2" class="form-label">Segundo nombre</label>
                        <input type="text" class="form-control" id="flt_nombre_2" placeholder="Ingrese segundo nombre"
                            required>
                        <div class="valid-feedback">
                            Perfecto!
                        </div>
                    </div>

                    <div class="col-md-6">
                        <label for="flt_apellidos" class="form-label">Apellidos</label>
                        <input type="text" class="form-control" id="flt_apellidos"
                            placeholder="Ingrese sus dos apellidos" required>
                        <div class="valid-feedback">
                            Perfecto!
                        </div>
                    </div>
                </div>

                <br>

                <div class="row">
                    <div class="col-md-6">
                        <label for="flt_canton" class="form-label">Cantón</label>
                        <select class="form-select" id="flt_canton" required>
                            <option selected>Selecciona un cantón o ciudad</option>
                        </select>
                        <input id="flt_canton_list" name="flt_canton_list" value="" type="hidden">
                        <div class="invalid-feedback">
                            Por favor, selecciona un cantón válido.
                        </div>
                    </div>

                    <div class="col-md-4">
                        <label for="datetimepicker1Input" class="form-label" style="font-weight: 500;">Fecha de
                            nacimiento
                        </label>
                        <div class="input-group" id="datetimepicker1" data-td-target-input="nearest"
                            data-td-target-toggle="nearest" style="width: 19rem;">
                            <input id="datetimepicker1Input" type="text" class="form-control"
                                data-td-target="#datetimepicker1" />
                            <span class="input-group-text" data-td-target="#datetimepicker1"
                                data-td-toggle="datetimepicker">
                                <span class="fas fa-calendar"></span>
                            </span>
                        </div>
                    </div>
                </div>

                <br>

                <div class="row">
                    <div class="col-md-6">
                        <label for="flt_nombre_representante" class="form-label">Nombre del Representante</label>
                        <input type="text" class="form-control" id="flt_nombre_representante"
                            placeholder="Ingrese nombre completo del representante" required>
                        <div class="valid-feedback">
                            Perfecto!
                        </div>
                    </div>

                    <div class="col-md-3">
                        <label for="flt_telefono" class="form-label">Celular</label>
                        <div class="input-group">
                            <span class="input-group-text">+593</span>
                            <input type="text" id="flt_telefono" class="form-control" placeholder="9xx-xxxxxx" required>
                        </div>
                        <div class="invalid-feedback">
                            Por favor, proporciona un número de celular válido (Ejemplo: +593 987654321).
                        </div>
                    </div>
                </div>

                <br>

                <div class="row">
                    <div class="col-12">
                        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                            <button type="submit" class="btn btn-primary">
                                <img src="/static/plugins/icons8/icons8-enviar-48.png" alt="Bootstrap" width="20"
                                    height="20">
                                Enviar </button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <br><br><br><br>
</div>

<script type="text/javascript" charset="utf-8">
    var fechaMinima = new Date();
    fechaMinima.setFullYear(fechaMinima.getFullYear() - 4);

    var fechaMaxima = new Date();
    fechaMaxima.setFullYear(fechaMinima.getFullYear() - 14);

    var fecha_min = moment(fechaMinima, 'YYYY-MM-DD').toDate();
    var fecha_max = moment(fechaMaxima, 'YYYY-MM-DD').toDate();

    const picker1 = new tempusDominus.TempusDominus(document.getElementById('datetimepicker1'), {
        restrictions: {
            maxDate: fecha_min,
            minDate: fecha_max
        },
        display: {
            components: {
                clock: false
            }
        },
        localization: {
            startOfTheWeek: 1,
            locale: 'es-EC',
            format: 'YYYY-MM-DD',
        }
    });
    picker1.dates.formatInput = date => moment(date).format('YYYY-MM-DD')
    picker1.dates.setValue(tempusDominus.DateTime.convert(fecha_min));

    datetimepicker1.addEventListener(tempusDominus.Namespace.events.change, (e) => {
        fecha3 = document.getElementById("datetimepicker1").value;
    });
</script>

<script type="text/javascript" charset="utf-8">
    // Función que me da los cantones y ciudades al select
    // Obtén el elemento select
    const selectCantones = document.getElementById('flt_canton');

    // Carga los datos desde el archivo JSON
    fetch('/static/plugins/admin/json/provincias.json')
        .then(response => response.json())
        .then(data => {
            // Rellena el select con los cantones de la provincia de Guayas
            const guayas = data['9']; // El código '9' corresponde a la provincia de Guayas
            if (guayas && guayas.cantones) {
                for (const cantonId in guayas.cantones) {
                    const canton = guayas.cantones[cantonId];
                    const option = document.createElement('option');
                    option.value = canton.canton;
                    option.text = canton.canton;
                    selectCantones.appendChild(option);
                }
            }
        })
        .catch(error => console.error('Error al cargar los datos: ' + error));
</script>

<script type="text/javascript" charset="utf-8">
    // Obtén el elemento de entrada
    const input = document.getElementById("flt_telefono");

    // Escucha el evento "input" para validar y formatear el número
    input.addEventListener("input", function () {
        let value = input.value;

        // Elimina caracteres no numéricos
        value = value.replace(/\D/g, '');

        // Aplica el formato 9xx-xxxxxx si hay más de 3 caracteres
        if (value.length > 3) {
            value = value.substring(0, 3) + '-' + value.substring(3, 9);
        } else if (value.length <= 3 && value.includes('-')) {
            // Si hay un guion pero no hay más de 3 caracteres, elimina el guion
            value = value.replace('-', '');
        }

        // Actualiza el valor en el campo de entrada
        input.value = value;
    });

    $(document).ready(function () {
        $('#flt_curso').change(function () {
            var elegidos = [];
            $(this).find(':selected').each(function (i, item) {
                elegidos[i] = $(item).val();
            });
            // console.log('lmqa -flt_curso elegidos..' + elegidos);
            $('#flt_curso_list').val(elegidos);
        });

        $('#flt_genero').change(function () {
            var elegidos = [];
            $(this).find(':selected').each(function (i, item) {
                elegidos[i] = $(item).val();
            });
            // console.log('lmqa -flt_genero elegidos..' + elegidos);
            $('#flt_genero_list').val(elegidos);
        });

        $('#flt_canton').change(function () {
            var elegidos = [];
            $(this).find(':selected').each(function (i, item) {
                elegidos[i] = $(item).val();
            });
            // console.log('lmqa -flt_canton elegidos..' + elegidos);
            $('#flt_canton_list').val(elegidos);
        });
    });
</script>


{% block content %}

{% endblock content %}

{% endblock %}

{% block body_end %}

{% endblock body_end %}